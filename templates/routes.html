{%extends "base.html"%} {%block Body%} {%for activity in data%}
<a href="/reset" class="btn btn-error">Log out</a>
<div class="card">
  <div class="card-header bg-primary">
    <div class="card-title text-center">
      <h2>Activity name: {{activity.name}}</h2>
    </div>
  </div>
  <div class="card-body text-center" style="width: 20%;">
    <p>Started at {{activity.start_date}}</p>
    <p>Activity took {{activity.elapsed_time}} seconds</p>
  </div>
</div>
{%endfor%}

<div style="display: inline;">
  <div id="map" style="width:1280px;height:720px"></div>
  <script>
    {
      let trajectories = {{ trajectories| tojson
    }};

    const getRandomColor = () => {
      var letters = '0123456789ABCDEF';
      var color = '#';
      for (var i = 0; i < 6; i++) {
        color += letters[Math.floor(Math.random() * 16)];
      }
      return color;
    }

    mapboxgl.accessToken = "{{ mapboxtoken }}";
    var map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/mapbox/dark-v10',
      center: [4.380068778991699, 50.85095984723529],
      zoom: 8
    });
    map.on('load', () => {
      let i = 0;
      trajectories.forEach(element => {
        i += 1;
        map.addSource(`route${i}`, {
          'type': 'geojson',
          'data': {
            'type': 'Feature',
            'properties': {},
            'geometry': {
              'type': 'LineString',
              'coordinates': element
            }
          }
        });
        map.addLayer({
          'id': `route${i}`,
          'type': 'line',
          'source': `route${i}`,
          'layout': {
            'line-join': 'round',
            'line-cap': 'round'
          },
          'paint': {
            'line-color': getRandomColor(),
            'line-width': 2
          }
        });
      });

    });
}
  </script>
</div>
{%endblock%}